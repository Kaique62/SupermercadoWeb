<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <title>Inventário com Tabs</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-light fixed-top" style="background: linear-gradient(to left, #ff6f00, #ffa040);">
    <div class="container d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center">
        <button class="btn btn-dark" onclick="history.back()"><i class="bi bi-arrow-left"></i></button>
        <h1 class="ms-3">🏪</h1>
        <span class="navbar-brand mb-0 h1">Mercado Didático</span>
      </div>
      <button class="btn btn-danger fs-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#perfilOffcanvas">
        <i class="bi bi-person-circle"></i>
      </button>
    </div>
  </nav>
  <!-- Container Principal -->
  <div class="container my-4 p-4 bg-white rounded shadow-sm">

    <!-- Título -->
    <div class="row mb-3">
      <div class="col-12">
        <h4 class="text-primary"><strong>📦 Inventário de Produtos</strong></h4>
      </div>
    </div>

    <!-- Linha de Pesquisa e Exclusão -->
    <div class="row g-3 align-items-end">

      <!-- Campo de Pesquisa -->
      <div class="col-md-6">
        <label for="pesquisa" class="form-label">Pesquisar produto (nome ou código)</label>
        <div class="input-group">
          <input type="text" class="form-control" id="pesquisa" placeholder="Ex: Arroz, 0012..."
            oninput="pesquisarHistorico()">
          <button class="input-group-text">🔍</button>
        </div>
      </div>

      <!-- Filtro por Categoria -->
      <div class="col-md-3">
        <label for="filtro-categoria" class="form-label">Categoria</label>
        <select class="form-select" id="filtro-categoria" onchange="pesquisarHistorico()">
          <option value="">Todas</option>
          <option value="entrada">Entrada</option>
          <option value="saida">Saída</option>
          <option value="alteracao">Alterações</option>
        </select>
      </div>

      <!-- Excluir -->
      <div class="col-md-3">
        <label for="campo-excluir" class="form-label">Apagar produto ou categoria</label>
        <div class="input-group">
          <input type="text" class="form-control" id="campo-excluir" placeholder="Ex: arroz ou entrada">
          <button class="btn btn-danger" onclick="confirmarExclusao()">🗑️ Apagar</button>
        </div>
      </div>
    </div>

    <!-- Resultados -->
    <div class="mt-4" id="resultado-pesquisa">
      <!-- Resultados da pesquisa serão renderizados aqui -->
    </div>

  </div>
  <!-- CONTAINER DE INFORMAÇÕES -->
  <div style="width: 1300px;"
    class="mx-auto d-flex justify-content-between align-items-center mb-3 p-3 rounded bg-primary text-white">
    <h4 class="mb-0"><i class="bi bi-archive"></i> Inventário</h4>
    <button class="btn btn-light fs-4" id="btn-recarrega-estoque" title="Recarregar Estoque" onclick="reloadPage()">
      <i class="bi bi-arrow-clockwise"></i>
    </button>
  </div>
  <!-- CONTAINER PRINCIPAL (MAIS COMPACTO) -->
  <div class="container-principal mt-4">
    <!-- ABAS -->
    <ul class="nav nav-tabs" id="historicoTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="entradas-tab" data-bs-toggle="tab" data-bs-target="#entradas" type="button"
          role="tab">
          <i class="bi bi-box-arrow-in-down me-1"></i>Entradas
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="saidas-tab" data-bs-toggle="tab" data-bs-target="#saidas" type="button" role="tab">
          <i class="bi bi-box-arrow-right me-1"></i>Saídas
        </button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="alteracoes-tab" data-bs-toggle="tab" data-bs-target="#alteracoes" type="button"
          role="tab">
          <i class="bi bi-pencil-square me-1"></i>Alterações
        </button>
      </li>
    </ul>

    <!-- CONTEÚDO DAS ABAS -->
    <div class="tab-content p-3" id="historicoTabsContent">
      <!-- ABA DE ENTRADAS -->
      <div class="tab-pane fade show active" id="entradas" role="tabpanel">
        <div class="titulo-painel text-success">Entradas Registradas</div>
        <div class="accordion scrollable-content" id="entradasAccordion"></div>
      </div>

      <!-- ABA DE SAÍDAS -->
      <div class="tab-pane fade" id="saidas" role="tabpanel">
        <div class="titulo-painel text-danger">Saídas Registradas</div>
        <div class="accordion scrollable-content" id="saidasAccordion"></div>
      </div>

      <!-- ABA DE ALTERAÇÕES -->
      <div class="tab-pane fade" id="alteracoes" role="tabpanel">
        <div class="titulo-painel text-primary">Alterações Registradas</div>
        <div class="accordion scrollable-content" id="alteracoesAccordion"></div>
      </div>
    </div>
  </div>

  <!-- Offcanvas de perfil -->
  <div class="offcanvas offcanvas-end bg-warning" tabindex="-1" id="perfilOffcanvas">
    <div class="offcanvas-header">
      <h5 class="fw-bold">Perfil</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
      <div class="perfil-box mb-3 bg-light rounded p-2">
        <i class="bi bi-person-circle"></i>
        <div class="d-flex flex-column">
          <p class="mb-0 fw-bold" id="userName"></p>
          <small class="text-muted" id="userRole"></small>
          <small class="text-muted"><strong>Email:</strong> <span id="userEmail"></span></small>
        </div>
      </div>
      <div>
        <a href="http://localhost:4000/login/"><button class="btn btn-danger w-100">Deslogar</button></a>
      </div>
    </div>
  </div>

  <!-- SCRIPTS (NO FINAL DO BODY PARA GARANTIR FUNCIONAMENTO) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js"></script>
</body>

</html>